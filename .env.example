# QuickText Jira MCP Server v4.2 - Environment Configuration

# ============================================
# TRANSPORT CONFIGURATION
# ============================================

# Transport mode: 'stdio' (default) | 'http'
# - stdio: Standard input/output (for Claude Desktop, Cline)
# - http: StreamableHTTP transport (for Postman MCP Client, testing)
MCP_TRANSPORT=stdio

# HTTP transport settings (only used when MCP_TRANSPORT=http)
MCP_HTTP_PORT=3000
MCP_HTTP_ENDPOINT=/mcp
MCP_BIND_ADDRESS=127.0.0.1
MCP_CORS_ORIGIN=*
MCP_HTTP_TIMEOUT=30000

# ============================================
# SECURITY CONFIGURATION (HTTP MODE)
# ============================================

# DNS Rebinding Protection
# Protects against malicious DNS rebinding attacks
# Set to 'true' in production, 'false' for development
MCP_ENABLE_DNS_PROTECTION=false

# Allowed Host headers (comma-separated)
# Example for production: jira-mcp.quicktext.internal,api.quicktext.com
# Leave empty to disable host validation
MCP_ALLOWED_HOSTS=

# Allowed Origin headers (comma-separated)
# Example for production: https://trusted-client.quicktext.com
# Use '*' for development (allows all origins)
# Leave empty to disable origin validation
MCP_ALLOWED_ORIGINS=*

# ============================================
# FUTURE FEATURES (NOT YET IMPLEMENTED)
# ============================================

# WebSocket transport port (future v4.3+)
# MCP_WS_PORT=3001

# EventStore resumability (future v4.3+)
# Enables client reconnection after disconnect
# MCP_ENABLE_RESUMABILITY=false

# ============================================
# SECURITY NOTES
# ============================================
# 
# ⚠️  MCP_BIND_ADDRESS is set to 127.0.0.1 (localhost) by default
#     This prevents external network access to the MCP server
#     Only change this if you understand the security implications
# 
# ⚠️  The Jira PAT token is hardcoded in jira-mcp-server.js
#     StreamableHTTP transport does NOT add authentication layer
#     Relies on localhost binding for security
# 
# ⚠️  CORS origin '*' allows all origins in development
#     In production, set MCP_CORS_ORIGIN to specific trusted domains
#
# ⚠️  Enable DNS rebinding protection in production
#     Set MCP_ENABLE_DNS_PROTECTION=true
#     Configure MCP_ALLOWED_HOSTS and MCP_ALLOWED_ORIGINS
# 
# ✅  Safe for local development and testing
# ❌  Do NOT expose to public internet without:
#     - Setting MCP_BIND_ADDRESS to specific interface
#     - Enabling DNS rebinding protection
#     - Restricting CORS origins
#     - Adding authentication layer (future feature)

# ============================================
# USAGE EXAMPLES
# ============================================
#
# Default (STDIO mode for Claude Desktop):
#   MCP_TRANSPORT=stdio
#   node jira-mcp-server.js
#
# HTTP mode for Postman testing (development):
#   MCP_TRANSPORT=http
#   MCP_HTTP_PORT=3000
#   MCP_ENABLE_DNS_PROTECTION=false
#   node jira-mcp-server.js
#   
#   Then connect Postman to: http://127.0.0.1:3000/mcp
#
# HTTP mode for production (with security):
#   MCP_TRANSPORT=http
#   MCP_HTTP_PORT=3000
#   MCP_BIND_ADDRESS=10.0.1.50
#   MCP_ENABLE_DNS_PROTECTION=true
#   MCP_ALLOWED_HOSTS=jira-mcp.quicktext.internal
#   MCP_ALLOWED_ORIGINS=https://trusted-client.quicktext.com
#   MCP_CORS_ORIGIN=https://trusted-client.quicktext.com
#   node jira-mcp-server.js

# ============================================
# ARCHITECTURE NOTES (v4.2)
# ============================================
#
# v4.2 Migration: SSEServerTransport → StreamableHTTPServerTransport
# - Uses official MCP Streamable HTTP specification (Nov 25, 2024)
# - Single unified /mcp endpoint (replaces /sse + /message)
# - Built-in session management with crypto.randomUUID()
# - DNS rebinding protection available
# - EventStore resumability planned for v4.3+
# - Deprecated SSEServerTransport removed
#
# MCP Protocol Compliance:
# - GET /mcp → SSE stream initialization
# - POST /mcp?sessionId=<id> → JSON-RPC message delivery
# - DELETE /mcp?sessionId=<id> → Session termination
#
# Transport Selection Logic:
# - MCP_TRANSPORT=stdio → StdioServerTransport (default)
# - MCP_TRANSPORT=http → StreamableHTTPServerTransport
# - Invalid value → Falls back to stdio
